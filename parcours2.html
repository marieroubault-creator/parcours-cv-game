<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Parcours à la carte - Gagne des points en déposant des CV</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body {
  margin: 0;
  font-family: "Marianne", Arial, sans-serif;
  background: linear-gradient(180deg, #eef3ff 0%, #f7f7f7 100%);
  color: #1d1e3c;
  overflow-x: hidden;
  position: relative;
}

/* Bandeau France Travail */
.ft-header {
  background: #406bde;
  color: white;
  text-align: center;
  padding: 6px 0;
  font-weight: bold;
  font-size: 16px;
  position: relative;
  z-index: 10;
}

/* Bandeau titre */
.header {
  background: #1d1e3c;
  color: white;
  padding: 16px 10px;
  text-align: center;
  border-bottom: 6px solid #6370c9;
  position: relative;
  z-index: 10;
}

.header h1 {
  margin: 0;
  font-size: 26px;
  font-weight: 600;
}

/* Actions haut */
.top-actions {
  position: absolute;
  top: 110px;
  left: 20px;
  display: flex;
  gap: 12px;
  z-index: 25;
}

/* Bouton retour */
.back-home {
  background: #406bde;
  color: white;
  text-decoration: none;
  padding: 10px 18px;
  border-radius: 30px;
  font-size: 0.95rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: background 0.2s ease, transform 0.2s ease;
}

.back-home:hover {
  background: #3559b8;
  transform: translateX(-3px);
}

/* Bouton start */
.start-btn {
  background: #ea6367;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 30px;
  font-size: 0.95rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  animation: pulse 2s infinite;
  transition: transform 0.2s ease, background 0.2s ease;
}

.start-btn:hover {
  background: #d65256;
  transform: scale(1.05);
}

/* Animation pulse */
@keyframes pulse {
  0% { box-shadow: 0 0 0 0 rgba(234,99,103,0.7); }
  70% { box-shadow: 0 0 0 14px rgba(234,99,103,0); }
  100% { box-shadow: 0 0 0 0 rgba(234,99,103,0); }
}

/* Barre d’état */
.status-bar {
  display: flex;
  justify-content: center;
  gap: 20px;
  flex-wrap: wrap;
  margin: 12px 0;
  position: relative;
  z-index: 10;
}

.status-item {
  background: white;
  padding: 10px 16px;
  border-left: 6px solid #1d1e3c;
  border-radius: 6px;
  font-size: 16px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

/* Carte */
#map-container {
  display: flex;
  justify-content: center;
  position: relative;
  z-index: 5;
}

#map {
  height: 75vh;
  width: 90%;
  max-width: 1000px;
  border: 4px solid #1d1e3c;
  border-radius: 12px;
}

/* Confettis */
#confetti-canvas {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 2;
}

/* Modales */
.modal-bg {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.modal {
  background: white;
  padding: 20px;
  border-radius: 12px;
  border: 3px solid #1d1e3c;
  width: 320px;
  text-align: center;
  position: relative;
}

.modal button {
  background: #1d1e3c;
  color: white;
  border: none;
  padding: 10px 16px;
  border-radius: 6px;
  cursor: pointer;
  margin-top: 12px;
}

.close-btn {
  position: absolute;
  top: 8px;
  right: 12px;
  font-size: 20px;
  cursor: pointer;
}
/* ================= FOOTER ================= */
.footer {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background: #a9c4ff;
  color: #1d1e3c;
  text-align: center;
  padding: 12px 10px;
  font-size: 0.95rem;
  font-weight: 500;
  z-index: 10;
}
/* Correction footer fixe */
#map-container {
  padding-bottom: 60px;
}
</style>
</head>

<body>

<div class="ft-header">FRANCE TRAVAIL</div>
<div class="header">
  <h1>Parcours à la carte - Gagne des points en déposant des CV</h1>
</div>

<div class="top-actions">
  <a href="index.html" class="back-home">
    <i class="fa-solid fa-house"></i> Retour à l’accueil
  </a>
  <button id="start-btn" class="start-btn">
    <i class="fa-solid fa-play"></i> Commencer le parcours
  </button>
</div>

<div class="status-bar">
  <div class="status-item">Score : <span id="score">0</span></div>
  <div class="status-item">Temps restant : <span id="timer">2:30:00</span></div>
</div>

<div id="map-container">
  <div id="map"></div>
  <canvas id="confetti-canvas"></canvas>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
/* MAP */
let map = L.map('map').setView([48.6519962, -2.0182998], 16);
L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);

/* SCORE */
let score = 0;
const updateScore = () => document.getElementById("score").textContent = score;

/* TIMER */
let totalSeconds = 2.5 * 3600;
setInterval(() => {
  let h = Math.floor(totalSeconds / 3600);
  let m = Math.floor((totalSeconds % 3600) / 60);
  let s = totalSeconds % 60;
  document.getElementById("timer").textContent =
    `${h}:${m.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`;
  if (--totalSeconds <= 0) location.reload();
}, 1000);

/* CONFETTIS */
let confettiCanvas = document.getElementById("confetti-canvas");
let myConfetti = confetti.create(confettiCanvas, { resize: true });
const launchConfetti = () => myConfetti({ particleCount: 200, spread: 80 });

/* POINTS & ÉNIGMES (inchangés) */
const points = {
  start:{name:"Hôtel Anne de Bretagne",address:"10/11 rue saint Thomas",coords:[48.65063,-2.02474],next:null}
};
const enigmes = {
  start:{q:"Qui est le corsaire emblématique de Saint-Malo ?",a:"surcouf"}
};

/* MARQUEUR DÉPART */
L.marker(points.start.coords).addTo(map).bindPopup("Point de départ");

/* MODALE */
function showEnigme(key){
  const modal=document.createElement("div");
  modal.className="modal-bg";
  modal.innerHTML=`
    <div class="modal">
      <span class="close-btn" onclick="this.closest('.modal-bg').remove()">×</span>
      <h3>${points[key].name}</h3>
      <p>${enigmes[key].q}</p>
      <input id="answer" style="width:90%;padding:6px"/>
      <button onclick="checkAnswer('${key}')">Valider</button>
    </div>`;
  document.body.appendChild(modal);
}

function checkAnswer(key){
  if(document.getElementById("answer").value.toLowerCase() === enigmes[key].a){
    score+=2; updateScore(); launchConfetti();
    document.querySelector(".modal-bg").remove();
  } else alert("Mauvaise réponse !");
}

/* DÉMARRAGE */
document.getElementById("start-btn").addEventListener("click", e => {
  e.target.style.display = "none";
  showEnigme("start");
});
</script>

<footer class="footer">
  © France Travail – Parcours à la carte | Dites le nous une fois
</footer>

</body>
</html>
